/* 本js由程序自动生成，如果您需要添加自己的js代码，请使用后台更新页底JS程序，添加 JS模块 */var bw= navigator.userAgent.toLowerCase();var page_url= unescape(window.location.href);var f_basename= location.href.match("[^/]*$")[0];var basename= f_basename.split('\?')[0];var page_referrer= document.referrer;var img_resize_width= 600;var img_resize_border= 1;var php2html_url= '';var article_id= 0;var url_vars= new Object();if ( typeof(hbcms_ctime) == 'undefined' ) {hbcms_dir= "";hbcms_tpl= "";hbcms_ctime = 0;}/* ################### cookie function start ################### */function hbcms_getCookieVal(offset) {var endstr = document.cookie.indexOf (";", offset);if (endstr == -1)endstr = document.cookie.length;return unescape(document.cookie.substring(offset, endstr));}function hbcms_GetCookie (name) {  var arg = name + "=";  var alen = arg.length;  var clen = document.cookie.length;  var i = 0;  while (i < clen) {    var j = i + alen;    if (document.cookie.substring(i, j) == arg)      return hbcms_getCookieVal (j);    i = document.cookie.indexOf(" ", i) + 1;    if (i == 0) break;   }  return null;}function hbcms_SetCookie (name, value) { var argv = hbcms_SetCookie.arguments;  var argc = hbcms_SetCookie.arguments.length;  var exp_days = (argc > 2) ? argv[2] : 30;var expires = new Date(); expires.setTime(expires.getTime() + (exp_days*24*3600*1000));var path = (argc > 3) ? argv[3] : '/';  var domain = (argc > 4) ? argv[4] : null;  var secure = (argc > 5) ? argv[5] : false;  document.cookie = name + "=" + escape (value) + ((expires == null) ? "" : ("; exp=" + expires.toGMTString())) + ((path == null) ? "" : ("; path=" + path)) +  ((domain == null) ? "" : ("; domain=" + domain)) +    ((secure == true) ? "; secure" : "");}function hbcms_DeleteCookie (name) {  var exp = new Date();  exp.setTime (exp.getTime() - 1);  var cval = hbcms_GetCookie (name);  document.cookie = name + "=" + cval + "; expires=" + exp.toGMTString();}/* ################### cookie function end ################### */function hbcms_randomValue(low, high) {return (Math.floor(Math.random() * (1 + high - low) + low));}function hbcms_last_modified_date(){var last_modified_date = new Date(document.lastModified);var s = ""+last_modified_date.getYear()+"-"+(last_modified_date.getMonth()+1)+"-"+last_modified_date.getDate()+" "+last_modified_date.getHours()+":"+last_modified_date.getMinutes()+":"+last_modified_date.getSeconds()+""; return s;}function hbcms_is_digit(s) {var patrn=/^[0-9]{0,200}$/; if (!patrn.exec(s)) return false;return true;}function hbcms_is_article(s) {var patrn=/\/(.){2}\/[0-9]{0,10}\.html$/; if (!patrn.exec(s)) return false;return true;}function hbcms_is_out_url(s){if ( s.indexOf(window.location.host) != -1 ){return false;}var patrn=/^http/; if (!patrn.exec(s)) return false;return true;}function hbcms_comment_form(id){if ( typeof(comment_author) == 'undefined' ){comment_author = "作者";}if ( typeof(comment_content) == 'undefined' ){comment_content = "内容";}if ( typeof(comment_submit) == 'undefined' ){comment_submit = "提交";}if ( typeof(to_user_id) == 'undefined' ){to_user_id = 1;}var author_value = '';var property = '';var loginName = hbcms_GetCookie('HBcmsLoginName');if ( loginName != null  ){author_value = loginName;property = "readonly style='border:0px;'";}s = "<form action=" + hbcms_dir + "/php/comment_add.php method=post target=hidden_iframe onsubmit=\"if ( this.comment_body.value==\'\' ) { alert(\'评论内容必须填写\');return false; }\" id=comment_form name=comment_form><table width=96%><tr><td>" + comment_author + ": <INPUT TYPE=text NAME=comment_author value='" + author_value + "' " + property + " style=\"background:transparent;\"> <br>" + comment_content + ": <TEXTAREA NAME=comment_body ROWS=5 COLS=50 style=\"width:95%\"></TEXTAREA></td></tr><tr><td align=center><input type=hidden name=article_id value="+id+"><input type=hidden name=to_user_id value="+to_user_id+"><INPUT TYPE=submit value=\"" + comment_submit + "\" class=butn></td></tr></table></form>";if ( document.getElementById('comment_form') != null ){document.getElementById('comment_form').innerHTML = s;}return true;}function hbcms_handle_page(){if ( typeof(hbcms_p2h_url) != 'undefined' ){php2html_url = hbcms_p2h_url;}if ( hbcms_tpl == 'index.tpl.html' ){php2html_url = hbcms_dir+'/php/index.php?create_date='+hbcms_ctime;}if ( hbcms_tpl == 'article_detail.tpl.html' ){for (i=0; i<document.links.length; i++){u = document.links[i].href;if ( hbcms_is_out_url(u) ) {if ( document.links[i].target == '' ){document.links[i].target = '_blank';}}}article_id = basename.split('\.')[0];if ( php2html_url == '' && hbcms_is_digit(article_id) ) {php2html_url = hbcms_dir+'/php/article_detail.php?article_id='+article_id+'&create_date='+hbcms_ctime;visited_page = hbcms_GetCookie('visited_page');cookie_article_id = article_id + '-';if ( visited_page == null ) {visited_page = cookie_article_id; } else {if ( visited_page.indexOf(cookie_article_id) == -1 ) {/* cookie太长则需要截取visited_page，以后再做了 */visited_page += cookie_article_id;document.write('<iframe src="'+hbcms_dir+'/php/update_article_hits.php?article_id='+article_id+'" width=0 height=0>Update article hits!</iframe>');}} hbcms_SetCookie('visited_page', visited_page, 2);}}if ( hbcms_tpl == 'article_list.tpl.html' ){type_pg = basename.split('\.')[0];type_pg_ary = type_pg.split('_');if ( php2html_url == '' && hbcms_is_digit(type_pg_ary[0]) && hbcms_is_digit(type_pg_ary[1]) ) {php2html_url = hbcms_dir+'/php/article_list.php?type_id='+type_pg_ary[0]+'&pageID='+type_pg_ary[1]+'&create_date='+hbcms_ctime;}for (i=0; i<document.links.length; i++){u = document.links[i].href;if ( hbcms_is_article(u) || hbcms_is_out_url(u) ) {if ( document.links[i].target == '' ){document.links[i].target = '_blank';}}}}}function hbcms_bottom_show(){url_vars = hbcms_getUrlVars();/* 各页面综合处理 */hbcms_handle_page();/* ######### 调用自动生成静态页的程序代码开始 ########## *//* http://www.hbcms.com 全球首创 2006-7-31 *//* 如需要转载，请注明 http://www.hbcms.com 首创 */var now = new Date();var last_modified = new Date(document.lastModified);var argv = hbcms_bottom_show.arguments;  var argc = hbcms_bottom_show.arguments.length;  var min = (argc > 0) ? parseInt(argv[0]) : 60*12;var stop_hour = (argc > 1) ? parseInt(argv[1]) : 24; var start_hour = (argc > 2) ? parseInt(argv[2]) : 0; var iframe_w = iframe_h = 1;if (window.location.host.indexOf('.test') != -1 ){min = 3;  /* hbcms.com开发团队的本地调试环境 */}if ( min<5 ){ /* debug mode */iframe_w = 300;iframe_h = 100;}if ( php2html_url.indexOf(".php") != -1 ){php2html_url = '' + php2html_url + '&mod=create_myself&step_min='+min+'&stop_hour='+stop_hour+'&start_hour='+start_hour+'&p2h_mod=0';if ( now.getTime() > (last_modified.getTime()+min*60*1000) && now.getHours() < stop_hour && now.getHours() >= start_hour ){document.write('<center><br>Note: Our system is recreating this page now <a href="javascript:location.reload();" title="Last recreate time: '+hbcms_last_modified_date()+'">Click here to reload</a><br><iframe src="' + php2html_url + '" border=0 width="'+iframe_w+'" height="'+iframe_h+'" frameborder="no" border="0" marginwidth="0" marginheight="0" scrolling="no" name="php2html_iframe"></iframe></center>');}}/* 如需要转载，请注明 http://www.hbcms.com 首创 *//* ######### 调用自动生成静态页的程序代码结束 ########## *//* 回写最后更新时间和管理员可看到的强制更新链接 */lm = document.getElementById('show_last_modified_date');if ( lm != null ){lm_str = '';if (lm.innerHTML != '' && php2html_url.indexOf(".php") != -1 ) {var loginInfo = hbcms_GetCookie('HBcmsLogin');if ( loginInfo != null && loginInfo.length>64 ){var login_name = '|' + loginInfo.substr(64) + '|';var lm_inner_html = '|' + lm.innerHTML + '|';if ( lm_inner_html.indexOf(login_name) != -1 ) {php2html_url = php2html_url.replace('p2h_mod=0','');php2html_url = php2html_url.replace("=create_myself","=create_html_now");lm_str = '<a href="' + php2html_url + '" title="You can see this link because you are the administrator!">Click here to recreate this page!</a>';if ( article_id > 0 ){lm_str += ' - <A HREF="'+hbcms_dir+'/admin/article_add.php?mod=edit&article_id='+article_id+'">Edit article</A>';}}}}lm.innerHTML = 'Last modified time: ' + hbcms_last_modified_date() + ' ' + lm_str;}document.write('<iframe src="about:blank" width=0 height=0 name=hidden_iframe></iframe>');hbcms_user_cpanel();hbcms_comment_form(article_id);hbcms_referrer_info();} /* 如果已经登录，显示用户的链接 */function hbcms_user_cpanel(){var loginName = hbcms_GetCookie('HBcmsLoginName');if( loginName != null && document.getElementById('user_cpanel_link')!=null && hbcms_GetCookie('HBcmsLogin')!=null ){document.getElementById('user_cpanel_link').innerHTML = ''+loginName + ' <img src=/hbcms/image/icon/users.png width=22 height=22 align=absmiddle /> <a href=/hbcms/user/index.php>会员控制中心</a> - <a href=/hbcms/user/login.php?logout=1>退出</a>';}}/* 最完美的自动缩小图片函数 www.hbcms.com 原创 */function hbcms_img_resize(i,w,b,retry){/* 本函数由 www.hbcms.com 原创，转载请保留此信息 */var t = document.images[i]; /* 创建新图片，重新获取原始图片的宽度高度 *//* 速度比onload快，可有效的防止图片指定了宽度高度 */var new_img = new Image();new_img.src = t.src; if ( typeof(w) == 'undefined'){w = 500;}if ( typeof(b) == 'undefined'){b = 1;}if ( typeof(retry) == 'undefined'){retry = 1;} else {retry = parseInt(retry)+1;}/* 本函数由 www.hbcms.com 原创，转载请保留此信息 *//* 尝试200次，如还没有获取到图片宽度，自动放弃 */if ( retry > 199 ){t.alt = 'HBcms image auto-resize note:\nResize was given up, retried ' + retry + ' times!';return true;}if ( new_img.width == 0 ){setTimeout("hbcms_img_resize('"+i+"','"+w+"','"+b+"','"+retry+"')",200);return true;}if(new_img.width>w){t.style.cursor='hand';t.width = w;t.height = new_img.height*(w/new_img.width);t.border = b;t.alt='!!!Image resized! Click here to see original image!!\n!!!Original width:' + new_img.width + ' Original height:' + new_img.height + ' Retry times:' + retry + ' !!!';/* 本函数由 www.hbcms.com 原创，转载请保留此信息 *//* 如果缩小了图片，自动给此图加上点击查看大图的链接 */t.onclick= function anonymous() {window.open(this.src+'');};}}function hbcms_img_resize_all(w,b){for (var i=0;i<document.images.length;i++) {if ( document.images[i].alt.indexOf('no_resize') == -1 ){hbcms_img_resize(i,w,b);}}}function hbcms_del_confirm(){if ( confirm("Are you sure you want to delete this?") ){return true;}return false;}function hbcms_stopError() {return true;}window.onerror = hbcms_stopError;function hbcms_getUrlVars(url) { var fVars     = new Object();var nameVal   = "";if ( typeof(url) == 'undefined' ){var inString  = location.search;} else {var inString  = '?' + url.split('?')[1];}var separator = ",";if (inString.charAt(0) == "?"){inString = inString.substring(1, inString.length);keypairs = inString.split("&");for (var i=0; i < keypairs.length; i++) { nameVal = keypairs[i].split("=");nameVal[0] = unescape(nameVal[0]);nameVal[1] = unescape(nameVal[1]);if (fVars[nameVal[0]]) {    fVars[nameVal[0]] += separator + nameVal[1]; } else {    fVars[nameVal[0]] = nameVal[1]; }} } return fVars; } /* 记录会员介绍ID referrer_id */function hbcms_referrer_info(){if ( page_referrer.indexOf("http") != -1 && page_referrer.indexOf("www.ixdba.net") == -1 ){referrer_url = hbcms_GetCookie("referrer_url");if ( referrer_url == null || referrer_url == ""){hbcms_SetCookie('referrer_url',page_referrer);}}referrer_id = hbcms_GetCookie("referrer_id");if ( ( page_url.indexOf("referrer_id=") != -1 || page_url.indexOf("referer_id=") != -1 ) && ( referrer_id == null || referrer_id == "" || referrer_id == 0 ) ){if ( page_url.indexOf("referrer_id=") != -1 ){hbcms_SetCookie('referrer_id',url_vars.referrer_id);} else {hbcms_SetCookie('referrer_id',url_vars.referer_id);}}}/*  hbcms ajax function */var hbcms_xml_req = false;var hbcms_xml_loading = '<CENTER><FONT face="arial,helvetica,clean,sans-serif;" size=3><IMG SRC="/hbcms/image/load/loading.gif" WIDTH="30" HEIGHT="30" BORDER="0" align=absmiddle onerror="this.width=0;"> Loading ..... Please wait ...... </FONT></CENTER>';function hbcms_ajax_req(url, functionName, httpType, sendData) { hbcms_xml_req = false; if (!httpType) httpType = "GET"; if (window.XMLHttpRequest) {   hbcms_xml_req = new XMLHttpRequest();  if (hbcms_xml_req.overrideMimeType) {   hbcms_xml_req.overrideMimeType('text/plain');  } } else if (window.ActiveXObject) {  try {   hbcms_xml_req = new ActiveXObject("Msxml2.XMLHTTP");  } catch (e) {   try {hbcms_xml_req = new ActiveXObject("Microsoft.XMLHTTP");   } catch (e) {}  } } if (!hbcms_xml_req) {  alert('Cannot send an XMLHTTP request');  return false; }var changefunc="hbcms_xml_req.onreadystatechange = "+functionName;eval (changefunc); hbcms_xml_req.open(httpType, url, true); hbcms_xml_req.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded'); hbcms_xml_req.send(sendData);}function hbcms_ajax_return (id) {document.getElementById(id).style.display = "block";if ( hbcms_xml_req && hbcms_xml_req.readyState == 4) {if (hbcms_xml_req.status == 200) {var s = hbcms_xml_req.responseText;if ( document.getElementById(id+'_loading') != null && s.indexOf('Error_Prompt:') != -1 ){document.getElementById(id+'_loading').innerHTML = s.replace('Error_Prompt:','');} else {document.getElementById(id).innerHTML = s;}} } else {if ( document.getElementById(id+'_loading') != null ){id = id+'_loading';}document.getElementById(id).innerHTML = hbcms_xml_loading; } return true;}function hbcms_show_article_content(article_id){hbcms_ajax_req(hbcms_dir+"/user/show_article_content.php","function(){ hbcms_ajax_return('hbcms_article_content')}","POST","article_id="+article_id+"");return false;}/* 加载 hbcms 核心的处理过程 */hbcms_bottom_show();/* 以下为用户自己定义的JS代码 */document.write("<center>");document.writeln("\r\n<!--\r\ndocument.write(\"本页最后更新日期: \" + document.lastModified)\r\n -->\r\n</sc"+"ript>");document.writeln("");var pbcn_ary = new Array("powered","by","hbcms");var pbcn=pbcn_ary.join("_");var pbcn_s = "s"+"tyle";document.writeln("<"+pbcn_s+">."+pbcn+" {font-family: Arial;text-align: center; color: #D9D9D9;}."+pbcn+" a:link, ."+pbcn+" a:visited{text-decoration:none;font-weight: bold; color: #D9D9D9;}."+pbcn+" u{text-decoration:none;font-weight: bold; color: #D9D9D9;}</"+pbcn_s+">");document.write("</center><a name=hbcms_bottom></a>");/* 加载 hbcms 非核心的处理过程 */if ( hbcms_tpl == 'article_detail.tpl.html'){hbcms_img_resize_all(img_resize_width, img_resize_border);}