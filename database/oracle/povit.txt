http://technology.amis.nl/2006/05/24/dynamic-sql-pivoting-stealing-antons-thunder/